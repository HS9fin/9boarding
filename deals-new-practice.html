<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>New Deals / Instruments Practice • 9Boarding</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
	<script src="https://cdn.tailwindcss.com"></script>
	<script>tailwind.config={theme:{extend:{colors:{brand:{50:'#e9eef9',100:'#cdd8f0',200:'#a9b9e2',300:'#7e95cf',400:'#566fb7',500:'#3a5498',600:'#2b417a',700:'#223665',800:'#1a2a4f',900:'#121d38'},surface:{100:'#f8fafc',200:'#eef2f7',300:'#e2e8f0'}}}}};</script>
	<style>html{font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,'Apple Color Emoji','Segoe UI Emoji';}body{overflow-x:hidden;}</style>
	<style>
	/* Keep everything inside Section 1 contained & responsive */
	#ndViewport{transition:none;}
	#nd-slide-1{max-width:100%; overflow:hidden;}
	#nd-slide-1 img{max-width:100%; height:auto; display:block;}
	/* Prevent inner grids from exceeding the card */
	#nd-slide-1 .grid{min-width:0;}
	#nd-slide-1 [class*="col-"]{min-width:0;}
	</style>
</head>
<body class="bg-white text-gray-900">
	<script>(function(){try{if(sessionStorage.getItem('9boarding:auth')!=='yes'){if(!location.pathname.endsWith('login.html')) location.replace('./login.html')}}catch(e){}})();</script>
	<header class="sticky top-0 z-40 bg-brand-800 shadow-sm">
		<div class="mx-auto max-w-7xl px-6 py-4 flex items-center gap-4 text-white">
			<a href="./index.html" class="flex items-center gap-3"><img src="./Images/9fin.jpg" alt="9fin logo" class="h-8 w-auto rounded object-contain" /><span class="text-lg font-semibold">9Boarding</span></a>
			<nav class="ml-auto hidden sm:flex items-center gap-6 text-sm"><a href="./index.html#workflows" class="text-white/90 hover:text-white">Workflows</a></nav>
		</div>
	</header>
	<main class="mx-auto max-w-7xl px-6 py-10">
		<a href="./deals.html" class="text-sm text-brand-700 hover:underline">← Back to Deals reading</a>
		<h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight mt-2">New Deals / Instruments — Practice</h1>
		<p class="mt-2 text-gray-600">Unlocks when the New Deals / Instruments reading is ticked.</p>
		<div id="guard" class="mt-6 hidden rounded-lg border border-amber-200 bg-amber-50 text-amber-900 p-4"><p class="font-medium">Locked: tick the New Deals / Instruments reading first</p><p class="text-sm mt-1">Go back to the <a href="./deals.html" class="underline">Deals reading list</a> and tick that item.</p></div>
		<section id="practiceContent" class="mt-8 hidden">
			<div class="rounded-xl border border-surface-200 bg-white/80 shadow-sm p-5">
				<div id="ndViewport" class="relative transition-all duration-300 ease-in-out overflow-hidden">
					<div id="ndTrack" class="flex flex-nowrap items-start transition-transform duration-300 ease-in-out">
						<!-- Section 1: Drag & Drop from Bank Blast -->
						<div class="min-w-full flex-none pr-0 md:pr-4" id="nd-slide-1">
							<h2 class="text-xl font-semibold">New Deals / Instruments — Populate Key Fields</h2>
							<p class="mt-2 text-sm text-gray-700">Drag the correct items from the palette onto the matching fields based on the bank blast. When finished, click Check answers.</p>
							<div class="mt-4 space-y-5">
								<!-- Bank blast reference (top of section) -->
								<div class="rounded-lg border border-surface-200 bg-white overflow-hidden">
									<a href="./Images/BankBlast4.png" target="_blank" rel="noopener" class="block">
										<img src="./Images/BankBlast4.png" alt="Bank blast" class="block w-full h-auto object-contain max-h-[70vh] md:max-h-[75vh] cursor-zoom-in" />
									</a>
								</div>
								<!-- Drag & drop work area (below image) -->
								<div>
									<h3 class="text-sm font-semibold text-brand-800">Fill these fields</h3>
									<div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3" id="nd-dnd-fields">
										<!-- Dropzones only; palette holds both correct and a few close-but-wrong items -->
										<div class="text-sm">
											<label class="block text-gray-700">Issuer</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="issuer" aria-label="Issuer dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Security</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="security" aria-label="Security dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Tranche size</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="size" aria-label="Tranche size dropzone"></div>
										</div>
										<!-- existing fields continue below -->
										<div class="text-sm">
											<label class="block text-gray-700">Tenor</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="tenor" aria-label="Tenor dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Non-call</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="call" aria-label="Call protection dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Corporate ratings (M/S)</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="corpRatings" aria-label="Corporate ratings dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Instrument ratings (M/S)</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="instRatings" aria-label="Instrument ratings dropzone"></div>
										</div>
										<div class="text-sm sm:col-span-2">
											<label class="block text-gray-700">Use of proceeds (UoP)</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="uop" aria-label="UoP dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Governing law</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="law" aria-label="Law dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Distribution</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="dist" aria-label="Distribution dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Lead Bookrunner(s)</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="sole" aria-label="Sole bookrunner dropzone"></div>
										</div>
										<div class="text-sm">
											<label class="block text-gray-700">Bookrunner(s)</label>
											<div class="nd-drop mt-1 min-h-[44px] rounded-md border border-surface-200 bg-white/70 p-2" data-field="joint" aria-label="Joint bookrunners dropzone"></div>
										</div>
									</div>

									<h3 class="mt-6 text-sm font-semibold text-brand-800">Palette</h3>
									<p class="text-xs text-gray-600">Drag items into the matching fields. You can drag them back to the palette to change.</p>
									<div id="nd-chip-palette" class="mt-2 flex flex-wrap gap-2"></div>

									<div class="mt-5 flex items-center gap-3">
										<button id="nd-dnd-check" class="inline-flex items-center rounded-md bg-brand-700 px-4 py-2 text-sm font-medium text-white hover:bg-brand-600">Check answers</button>
										<button id="nd-dnd-reset" class="inline-flex items-center rounded-md bg-surface-200 px-4 py-2 text-sm font-medium text-gray-900 hover:bg-surface-300">Reset</button>
									</div>
									<div id="nd-dnd-result" class="hidden mt-3 rounded-md border p-3 text-sm"></div>
								</div>
							</div>
							<div class="border-t border-surface-200 pt-5 flex items-center gap-3 mt-6">
								<div class="text-xs text-gray-600">Page <span class="font-semibold" data-nd-page>1</span> of 2</div>
								<button id="nd-next-1" class="ml-auto inline-flex items-center justify-center rounded-md bg-brand-700 px-4 py-2 text-sm font-medium text-white shadow hover:bg-brand-600">Next →</button>
							</div>
						</div>
						<!-- Section 2 (empty placeholder) -->
						<div class="min-w-full flex-none pl-0 md:pl-4" id="nd-slide-2">
							<h2 class="text-xl font-semibold">New Deals / Instruments — Section 2</h2>
							<p class="mt-2 text-sm text-gray-700">Placeholder — add your content here.</p>
							<div class="border-t border-surface-200 pt-5 flex items-center gap-3 mt-4">
								<div class="text-xs text-gray-600">Page <span class="font-semibold" data-nd-page>2</span> of 2</div>
								<button id="nd-prev-2" class="inline-flex items-center justify-center rounded-md bg-surface-200 px-4 py-2 text-sm font-medium text-gray-900 hover:bg-surface-300">← Previous</button>
								<a href="./deals.html" class="ml-auto inline-flex items-center justify-center rounded-md bg-brand-700 px-4 py-2 text-sm font-medium text-white shadow hover:bg-brand-600">Back to Deals</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
	</main>
	<footer class="mt-16 border-t border-surface-200">
		<div class="mx-auto max-w-7xl px-6 py-8 text-sm text-gray-500 flex items-center justify-between">
			<p>© <span id="year"></span> 9Boarding</p>
			<a class="hover:text-brand-700" href="mailto:people@9fin.com">Contact People Ops</a>
		</div>
	</footer>
	<script>
		document.getElementById('year').textContent=new Date().getFullYear();
		const KEY='9boarding:deals:reading';
		const saved=JSON.parse(localStorage.getItem(KEY)||'{}');
		const unlocked=!!saved['notion:new-deals-instruments'];
		const guard=document.getElementById('guard');
		const content=document.getElementById('practiceContent');
		if(unlocked){content.classList.remove('hidden')} else {guard.classList.remove('hidden')}
		// Minimal slider logic to mirror Deals Updates structure
		const ndTrack=document.getElementById('ndTrack');
		const ndViewport=document.getElementById('ndViewport');
		const ndSlides=ndTrack?Array.from(ndTrack.querySelectorAll('[id^="nd-slide-"]')):[];
		let ndIndex=0; let ndResizeObs;
		function ndSync(){document.querySelectorAll('[data-nd-page]').forEach(el=>el.textContent=ndIndex+1)}
		function ndObserve(){
			if(!ndSlides.length) return;
			const active=ndSlides[ndIndex]; if(!active) return;
			if(ndResizeObs) ndResizeObs.disconnect();
			ndViewport.style.overflow='hidden'; ndViewport.style.maxHeight='none'; ndViewport.style.minHeight='0';
			const compute=()=>{const cs=getComputedStyle(active); const mt=parseFloat(cs.marginTop)||0; const mb=parseFloat(cs.marginBottom)||0; const h=active.scrollHeight+mt+mb; if(h>0) ndViewport.style.height=h+'px'};
			ndResizeObs=new ResizeObserver(compute); ndResizeObs.observe(active); compute(); ndSync();
		}
		function ndUpdate(){ndObserve()}
		function ndGoTop(){try{window.scrollTo({top:0,behavior:'smooth'})}catch{window.scrollTo(0,0)}}
		document.getElementById('nd-next-1')?.addEventListener('click',()=>{ndIndex=1; ndTrack.style.transform='translateX(-100%)'; setTimeout(()=>{ndUpdate(); ndGoTop()},160)})
		document.getElementById('nd-prev-2')?.addEventListener('click',()=>{ndIndex=0; ndTrack.style.transform='translateX(0)'; setTimeout(()=>{ndUpdate(); ndGoTop()},160)})
		document.addEventListener('DOMContentLoaded',()=> setTimeout(ndUpdate,120)); if(unlocked) setTimeout(ndUpdate,120); window.addEventListener('resize',()=> setTimeout(ndUpdate,120));

		// --- Drag & Drop for Section 1 ---
		const chipsData=[
			{key:'issuer', label:'Duomo BidCo S.p.A.', val:'Duomo BidCo S.p.A.'},
			{key:'security', label:'Senior Secured FRNs', val:'Senior Secured FRNs'},
			{key:'size', label:'€540m', val:'€540m'},
			{key:'tenor', label:'6', val:'6'},
			{key:'call', label:'NC1', val:'NC1'},
			{key:'corpRatings', label:'B2 (stable) / B+ (stable)', val:'B2 (stable) / B+ (stable)'},
			{key:'instRatings', label:'B2 / B+', val:'B2 / B+'},
			{key:'uop', label:'Refinancing', val:' Refinancing'},
			{key:'law', label:'New York', val:'New York'},
			{key:'dist', label:'RegS / 144A', val:'RegS / 144A'},
			{key:'sole', label:'Deutsche Bank', val:'Deutsche Bank'},
			{key:'joint', label:'Deutsche Bank, Barclays, Intesa Sanpaolo, UniCredit', val:'Deutsche Bank,Barclays, Intesa Sanpaolo, UniCredit'},
			// Close-but-wrong distractors (palette only)
			{key:'issuer_x', label:'Duomo BidCo S.p.A. (DUOMBI)', val:''},
			{key:'security_x', label:'Senior Secured Notes', val:''},
			{key:'size_x', label:'€500m', val:''},
			{key:'tenor_x', label:'5 years', val:''},
			{key:'call_x', label:'NC1 / 102', val:''},
			{key:'corpRatings_x', label:'B2 (stable) / B (stable)', val:''},
			{key:'instRatings_x', label:'B2 / B (stable)', val:''},
			{key:'uop_x', label:'Refinance FRNs and general corporate purposes', val:''},
			{key:'law_x', label:'English law', val:''},
			{key:'dist_x', label:'RegS only', val:''},
			{key:'sole_x', label:'Deutsche Bank', val:''},
			{key:'joint_x', label:'Barclays, UniCredit', val:''},
        
		];
		const correctMap={}; chipsData.forEach(c=>{correctMap[c.key]=c.val});
		const palette=document.getElementById('nd-chip-palette');
		const drops=Array.from(document.querySelectorAll('.nd-drop'));
		let draggingEl=null;
		function chipEl(text, key){
			const b=document.createElement('button');
			b.type='button'; b.textContent=text; b.draggable=true; b.dataset.key=key;
			b.className='nd-chip inline-flex items-center gap-1 rounded-full border border-brand-200 bg-brand-50 px-3 py-1 text-xs font-medium text-brand-800 hover:bg-brand-100 active:scale-[.99]';
			b.addEventListener('dragstart',e=>{draggingEl=b; e.dataTransfer.setData('text/plain', JSON.stringify({key, text})); e.dataTransfer.effectAllowed='move';});
			return b;
		}
		function renderPalette(){
			palette.innerHTML='';
			// Shuffle chips to mix up order each render
			const arr=chipsData.slice();
			for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]}
			arr.forEach(c=> palette.appendChild(chipEl(c.label,c.key)));
		}
		function dropzoneHandlers(zone){
			zone.addEventListener('dragover',e=>{e.preventDefault(); zone.classList.add('ring-2','ring-brand-300')});
			zone.addEventListener('dragleave',()=> zone.classList.remove('ring-2','ring-brand-300'));
			zone.addEventListener('drop',e=>{
				e.preventDefault(); zone.classList.remove('ring-2','ring-brand-300');
				if(!draggingEl) return;
				// Remove any existing chip in this zone
				zone.querySelector('.nd-chip')?.remove();
				zone.appendChild(draggingEl);
				// Allow double-click to send back to palette
				draggingEl.addEventListener('dblclick',()=>{palette.appendChild(draggingEl); ndUpdate()});
				draggingEl=null; ndUpdate();
			});
		}
		drops.forEach(dropzoneHandlers);
		palette?.addEventListener('dragover',e=>{e.preventDefault()});
		palette?.addEventListener('drop',e=>{
			e.preventDefault(); if(!draggingEl) return; palette.appendChild(draggingEl); draggingEl=null; ndUpdate();
		});
		function checkAnswers(){
			const resEl=document.getElementById('nd-dnd-result'); let ok=true; let messages=[];
			drops.forEach(z=>{
				const key=z.dataset.field; const txt=z.querySelector('.nd-chip')?.textContent?.trim();
				if(!txt){ ok=false; messages.push(`<li>Missing: ${key}</li>`); return; }
				const expected=correctMap[key]; if(txt!==chipsData.find(c=>c.key===key)?.label){ ok=false; messages.push(`<li>Incorrect: ${key}</li>`); }
			});
			resEl.classList.remove('hidden','border-green-200','bg-green-50','text-green-800','border-red-200','bg-red-50','text-red-800');
			if(ok){resEl.classList.add('border-green-200','bg-green-50','text-green-800'); resEl.innerHTML='<p class="font-semibold">All set</p><p class="mt-1">Great job — everything matches the blast.</p>'}
			else{resEl.classList.add('border-red-200','bg-red-50','text-red-800'); resEl.innerHTML=`<p class="font-semibold">Not yet</p><ul class="list-disc ml-4 mt-1">${messages.join('')}</ul><p class="mt-2 text-xs text-gray-700">Tip: double‑click a chip to return it to the palette.</p>`}
			ndUpdate();
		}
		function resetDnd(){
			// Move all chips back
			drops.forEach(z=>{z.querySelectorAll('.nd-chip').forEach(ch=> palette.appendChild(ch));});
			document.getElementById('nd-dnd-result')?.classList.add('hidden'); ndUpdate();
		}
		document.getElementById('nd-dnd-check')?.addEventListener('click',checkAnswers);
		document.getElementById('nd-dnd-reset')?.addEventListener('click',resetDnd);
		renderPalette();
	</script>
</body>
</html>
